const a24_0x3daa6c=a24_0x1aa4;(function(_0x3ed6e0,_0x49f19c){const _0xfbc0bd=a24_0x1aa4,_0x3b0258=_0x3ed6e0();while(!![]){try{const _0x3600cb=-parseInt(_0xfbc0bd(0x1c9))/0x1+parseInt(_0xfbc0bd(0x1d7))/0x2*(parseInt(_0xfbc0bd(0x1e2))/0x3)+-parseInt(_0xfbc0bd(0x1c8))/0x4*(-parseInt(_0xfbc0bd(0x1d0))/0x5)+-parseInt(_0xfbc0bd(0x1e0))/0x6*(-parseInt(_0xfbc0bd(0x1d9))/0x7)+-parseInt(_0xfbc0bd(0x1ba))/0x8*(parseInt(_0xfbc0bd(0x1bf))/0x9)+-parseInt(_0xfbc0bd(0x1bd))/0xa*(parseInt(_0xfbc0bd(0x1d6))/0xb)+parseInt(_0xfbc0bd(0x1ce))/0xc*(parseInt(_0xfbc0bd(0x1cb))/0xd);if(_0x3600cb===_0x49f19c)break;else _0x3b0258['push'](_0x3b0258['shift']());}catch(_0x58decc){_0x3b0258['push'](_0x3b0258['shift']());}}}(a24_0x44f9,0x85cd6));import a24_0x556d40 from'express';function a24_0x44f9(){const _0x242d2a=['SIGINT','4525297XSHAXU','users','passwordHash','request','set','length','bind','6oRWEZE','close','3KfkDJG','role','SIGQUIT','sub','url','toHexString','stop','once','findBy','*\x200\x200\x20*\x20*\x20*','104BJtaas','/ping','userRole','460CJROYQ','listen','411003tuKYcY','destroy','SIGTERM','common','log','includes','initialize','TurboGis1?','admin','1804QtMUwq','200664cvrmjQ','username','806sacofN','findOne','Authorization\x20is\x20required\x20for\x20request\x20on\x20','28932AuPbwY','project\x20user','8590WLZwYM','pong\x20TurboGis','start','get','forEach','trust\x20proxy','143814VOzoLA','746044SvKkYP'];a24_0x44f9=function(){return _0x242d2a;};return a24_0x44f9();}import{UnauthorizedError,useExpressServer}from'routing-controllers';import{getAndVerifyAccessToken}from'./auth/jwt.js';import a24_0xb710e2 from'./controllers/AuthController.js';import a24_0x29d1f8 from'./controllers/ProjectController.js';import a24_0x34a31e from'./controllers/UserController.js';import a24_0x1cdcf5 from'./database.js';import a24_0x474664 from'./entities/User.js';import a24_0x13584b from'./entities/Project.js';import{hashPassword}from'./auth/password.js';import a24_0x17e6ca from'morgan';import{CronJob}from'cron';import a24_0x4e8149 from'./entities/RevokedRefreshToken.js';import{LessThan}from'typeorm';import a24_0x4630b4 from'./errors/ErrorHandler.js';function a24_0x1aa4(_0x1b4763,_0x53c594){const _0x44f92d=a24_0x44f9();return a24_0x1aa4=function(_0x1aa472,_0x17789f){_0x1aa472=_0x1aa472-0x1b6;let _0x34ba78=_0x44f92d[_0x1aa472];return _0x34ba78;},a24_0x1aa4(_0x1b4763,_0x53c594);}import{promisify}from'util';const app=a24_0x556d40();app[a24_0x3daa6c(0x1dd)](a24_0x3daa6c(0x1d5),0x1),app['use'](a24_0x17e6ca(a24_0x3daa6c(0x1c2))),app[a24_0x3daa6c(0x1d3)](a24_0x3daa6c(0x1bb),(_0x5c9fdf,_0x262531)=>_0x262531['send'](a24_0x3daa6c(0x1d1))),useExpressServer(app,{'controllers':[a24_0xb710e2,a24_0x29d1f8,a24_0x34a31e],'middlewares':[a24_0x4630b4],'defaultErrorHandler':![],'classTransformer':!![],'classToPlainTransformOptions':{'excludeExtraneousValues':!![]},'plainToClassTransformOptions':{'excludeExtraneousValues':!![]},'validation':!![],'cors':!![],'currentUserChecker':_0x565a78=>{const _0x5436e3=a24_0x3daa6c;try{let _0x1afc5d=getAndVerifyAccessToken(_0x565a78[_0x5436e3(0x1dc)]);return a24_0x474664[_0x5436e3(0x1cc)]({'where':{'id':_0x1afc5d['sub']},'relations':{'projects':!![],'measurements':!![]}});}catch(_0x4cee27){return undefined;}},'authorizationChecker':async(_0x395aab,_0x50154e)=>{const _0x320b46=a24_0x3daa6c;try{let _0x10131f=getAndVerifyAccessToken(_0x395aab[_0x320b46(0x1dc)]);if(_0x10131f[_0x320b46(0x1bc)]==='admin'||_0x50154e[_0x320b46(0x1de)]===0x0)return!![];if(_0x50154e[_0x320b46(0x1c4)]('current\x20user'))return _0x10131f['sub']===_0x395aab[_0x320b46(0x1dc)]['params']['id'];if(_0x50154e['includes'](_0x320b46(0x1cf))){let _0x1b26db=await a24_0x13584b[_0x320b46(0x1cc)]({'where':{'id':_0x395aab[_0x320b46(0x1dc)]['params']['id']},'relations':{'users':!![]}});if(_0x1b26db&&_0x1b26db[_0x320b46(0x1da)]['find'](_0x16fc3c=>_0x16fc3c['id']===_0x10131f[_0x320b46(0x1e5)]))return!![];}return![];}catch(_0xecdc0a){let _0x5ccb7d=_0x395aab[_0x320b46(0x1dc)];throw new UnauthorizedError(_0x320b46(0x1cd)+_0x5ccb7d['method']+'\x20'+_0x5ccb7d[_0x320b46(0x1e6)]);}}}),await a24_0x1cdcf5[a24_0x3daa6c(0x1c5)]();let adminUsers=await a24_0x474664[a24_0x3daa6c(0x1b8)]({'role':a24_0x3daa6c(0x1c7)});if(adminUsers[a24_0x3daa6c(0x1de)]===0x0){let defaultUser=new a24_0x474664();defaultUser[a24_0x3daa6c(0x1ca)]=a24_0x3daa6c(0x1c7),defaultUser[a24_0x3daa6c(0x1db)]=(await hashPassword(a24_0x3daa6c(0x1c6)))[a24_0x3daa6c(0x1e7)](),defaultUser[a24_0x3daa6c(0x1e3)]=a24_0x3daa6c(0x1c7),await defaultUser['save']();}const removeExpiredTokensJob=new CronJob(a24_0x3daa6c(0x1b9),async()=>{const _0x14d778=a24_0x3daa6c;let _0x3925af=await a24_0x4e8149[_0x14d778(0x1b8)]({'expiryDate':LessThan(new Date())});await a24_0x4e8149['remove'](_0x3925af);});removeExpiredTokensJob[a24_0x3daa6c(0x1d2)]();const server=app[a24_0x3daa6c(0x1be)](0xbb8,()=>console[a24_0x3daa6c(0x1c3)]('GET\x20...\x20some\x20bitches\x20on\x20port',0xbb8,'ðŸ’€')),closeServerAsync=promisify(server[a24_0x3daa6c(0x1e1)][a24_0x3daa6c(0x1df)](server)),exitSignals=[a24_0x3daa6c(0x1d8),a24_0x3daa6c(0x1c1),a24_0x3daa6c(0x1e4)];exitSignals[a24_0x3daa6c(0x1d4)](_0x10069f=>process[a24_0x3daa6c(0x1b7)](_0x10069f,async()=>{const _0x42b6a9=a24_0x3daa6c;console[_0x42b6a9(0x1c3)]('Received\x20'+_0x10069f+'\x20signal,\x20shutting\x20down.'),await closeServerAsync(),removeExpiredTokensJob[_0x42b6a9(0x1b6)](),await a24_0x1cdcf5[_0x42b6a9(0x1c0)]();}));